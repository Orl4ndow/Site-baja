<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Gestão de Eletrônica - Projeto Baja SAE</title>
    <link rel="icon" type="image/png" href="modelo.PNG">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <link rel="stylesheet" href="style.css">

    <style>
        /* Estilos específicos do Kanban (Usando Tailwind e custom) */
        .kanban-board-container {
            display: flex;
            gap: 16px; /* gap-4 */
            overflow-x: auto; /* Permite scroll horizontal se muitas colunas */
            padding-bottom: 10px;
        }
        .kanban-column-style {
            min-width: 280px; /* Largura mínima para mobile */
            max-width: 350px;
            width: 100%;
            background-color: #f1f5f9; /* gray-100 */
            border-radius: 8px; /* rounded-lg */
            padding: 16px; /* p-4 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); /* shadow-md */
            flex-shrink: 0; /* Impede o encolhimento das colunas */
        }
        .kanban-column-style h3 {
            font-size: 1.125rem; /* text-xl */
            font-weight: 600; /* font-semibold */
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e2e8f0; /* gray-200 */
        }
        .card-list {
            min-height: 20px;
            padding-bottom: 10px;
        }
        .kanban-card {
            background-color: white;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 10px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
            cursor: grab;
            border-left: 5px solid;
            overflow-wrap: break-word; /* CORRIGIDO: Força quebras de linha em palavras longas */
            word-break: break-word; 
            display: flex; /* Adicionado para alinhar texto e botão de exclusão */
            flex-direction: column; /* Para empilhar o título e as datas */
        }
        .kanban-card:hover {
             background-color: #f9fafb;
        }
        .kanban-card:active {
            opacity: 0.7;
            cursor: grabbing;
        }
        /* Cores das colunas */
        #column-todo .kanban-card { border-left-color: #f97316; /* Laranja */ }
        #column-doing .kanban-card { border-left-color: #3b82f6; /* Azul */ }
        #column-done .kanban-card { border-left-color: #10b981; /* Verde */ }

        .add-card-btn {
            width: 100%;
            padding: 8px;
            border: 1px dashed #94a3b8; /* slate-400 */
            color: #475569; /* slate-600 */
            background-color: transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .add-card-btn:hover {
            background-color: #e2e8f0; /* gray-200 */
        }
        .delete-card-btn {
            color: #ef4444; /* red-500 */
            margin-left: 8px;
            cursor: pointer;
            flex-shrink: 0; /* Impede o encolhimento */
            font-weight: bold; /* Deixa o 'X' mais visível */
            font-size: 1.2em;
        }
        .card-text {
            flex-grow: 1;
        }
        
        /* CORREÇÕES ESSENCIAIS PARA MOBILE ABAIXO */
        body { 
            /* A chave: Impede que o conteúdo lateral fixo crie uma rolagem horizontal. */
            overflow-x: hidden; 
        }

        /* Estilos para FIXAR A BARRA DE NAVEGAÇÃO em telas maiores */
        @media (min-width: 768px) {
            #main-nav {
                position: fixed;
                height: 100vh;
                top: 0;
                left: 0;
            }
        }
        /* Apenas em mobile, o <body> é flex, mas a main não precisa da margem lateral (já que a nav fica oculta) */
        @media (max-width: 767px) {
            .flex { 
                display: block; /* Desativa o flex do body em mobile para evitar layout stretch */
            }
            .md\:ml-64 {
                margin-left: 0 !important; /* Remove a margem quebra-layout do main */
            }
        }
    </style>
</head>
<body class="flex bg-gray-100">

    <div id="loading-overlay" class="fixed inset-0 bg-white/90 backdrop-blur-sm flex justify-center items-center z-50">
        <div class="text-center">
            <div class="loader mx-auto"></div>
            <p class="mt-4 text-gray-600 font-semibold">Carregando dashboard...</p>
        </div>
    </div>

    <div id="mobile-nav-overlay"></div>

    <nav id="main-nav" class="w-64 bg-white shadow-lg flex-col flex">
        <div class="p-6 text-center border-b">
            <h1 class="text-xl font-bold text-indigo-600">Quarter Mile BAJA Eletrônica UERJ</h1>
            <p class="text-sm text-gray-500">Painel de Gestão</p> 
	    
        </div>
        <ul class="flex-grow p-4 space-y-2 overflow-y-auto">
            <li><a href="https://drive.google.com/drive/u/3/folders/1bMHMuoTwH96tJvcNmbKg7t-BqnMxkMVP" target="_blank" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100"><i data-lucide="folder-heart" class="w-5 h-5 mr-3"></i>Projetos Prontos</a></li>
	    <li><a href="#dashboard" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100 active"><i data-lucide="layout-dashboard" class="w-5 h-5 mr-3"></i>Dashboard</a></li>
            <li><a href="#kanban" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100"><i data-lucide="layout-grid" class="w-5 h-5 mr-3"></i>Kanban</a></li>
            <li><a href="#escopo" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100"><i data-lucide="file-text" class="w-5 h-5 mr-3"></i>Escopo</a></li>
            <li><a href="#eap" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100"><i data-lucide="network" class="w-5 h-5 mr-3"></i>EAP</a></li>
            <li><a href="#cronograma" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100"><i data-lucide="calendar-days" class="w-5 h-5 mr-3"></i>Cronograma</a></li>
            <li><a href="#riscos" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100"><i data-lucide="shield-alert" class="w-5 h-5 mr-3"></i>Riscos</a></li>
            <li><a href="#reunioes" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100"><i data-lucide="users" class="w-5 h-5 mr-3"></i>Reuniões</a></li>
            <li><a href="#links" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100"><i data-lucide="link" class="w-5 h-5 mr-3"></i>Links Úteis</a></li>
            <li><a href="#avisos" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100"><i data-lucide="megaphone" class="w-5 h-5 mr-3"></i>Avisos</a></li>
            <li><a href="https://drive.google.com/drive/folders/1sTkMYff2q_Vl-8kONZ3f0_bEC3pyS9Tx?usp=drive_link" target="_blank" class="nav-link flex items-center p-3 rounded-lg hover:bg-gray-100"><i data-lucide="folder-kanban" class="w-5 h-5 mr-3"></i>Inventário</a></li>
        </ul>
        <div class="p-4 border-t">
            <a href="#edicao" id="config-link" class="nav-link w-full flex items-center justify-center text-sm p-3 rounded bg-indigo-100 hover:bg-indigo-200 text-indigo-800 font-semibold"><i data-lucide="settings" class="w-5 h-5 mr-2"></i></a>
        </div>
    </nav>

    <main class="flex-1 flex flex-col h-screen md:ml-64">
        <header id="mobile-header" class="md:hidden sticky top-0 bg-white/80 backdrop-blur-sm shadow-sm p-4 z-20 flex justify-between items-center">
            <button id="mobile-menu-button" class="p-2">
                <i data-lucide="menu" class="w-6 h-6"></i>
            </button>
            <h2 id="mobile-page-title" class="text-lg font-bold text-indigo-600">Dashboard</h2>
        </header>

        <div class="flex-1 p-4 md:p-8 overflow-y-auto">
            <div id="dashboard" class="page active"><h2 class="text-3xl font-bold mb-6 text-gray-800">Dashboard</h2><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><div class="bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-2">Próximos Prazos</h3><div class="overflow-x-auto"><div id="dashboard-prazos" class="text-gray-700 space-y-1 whitespace-pre"></div></div></div><div class="bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-2">Riscos Críticos</h3><div class="overflow-x-auto"><div id="dashboard-riscos" class="text-gray-700 space-y-1 whitespace-pre"></div></div></div><div class="bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-2">Última Reunião</h3><div class="overflow-x-auto"><div id="dashboard-reuniao" class="text-gray-700 space-y-1 whitespace-pre"></div></div></div></div><div class="mt-8 bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-2 flex items-center"><i data-lucide="megaphone" class="w-5 h-5 mr-2"></i>Quadro de Avisos</h3><div class="overflow-x-auto"><div id="avisos-dashboard-content" class="text-gray-700 space-y-2 whitespace-pre"></div></div></div></div>

            <div id="kanban" class="page">
                <h2 class="text-3xl font-bold mb-6">Quadro Kanban de Tarefas</h2>
                <div class="kanban-board-container" id="kanban-board">
                    <!-- Coluna A FAZER -->
                    <div class="kanban-column-style" id="column-todo" ondrop="kanbanDrop(event)" ondragover="kanbanAllowDrop(event)">
                        <h3 class="text-orange-600">A Fazer</h3>
                        <div class="card-list" id="card-list-todo">
                            <!-- Cards serão inseridos aqui pelo JS -->
                        </div>
                        <button class="add-card-btn" onclick="kanbanRequestCardName('todo')">+ Adicionar Card</button>
                    </div>

                    <!-- Coluna EM PROGRESSO -->
                    <div class="kanban-column-style" id="column-doing" ondrop="kanbanDrop(event)" ondragover="kanbanAllowDrop(event)">
                        <h3 class="text-blue-600">Em Progresso</h3>
                        <div class="card-list" id="card-list-doing">
                            <!-- Cards serão inseridos aqui pelo JS -->
                        </div>
                        <button class="add-card-btn" onclick="kanbanRequestCardName('doing')">+ Adicionar Card</button>
                    </div>

                    <!-- Coluna CONCLUÍDO -->
                    <div class="kanban-column-style" id="column-done" ondrop="kanbanDrop(event)" ondragover="kanbanAllowDrop(event)">
                        <h3 class="text-green-600">Concluído</h3>
                        <div class="card-list" id="card-list-done">
                            <!-- Cards serão inseridos aqui pelo JS -->
                        </div>
                        <button class="add-card-btn" onclick="kanbanRequestCardName('done')">+ Adicionar Card</button>
                    </div>
                </div>
            </div>

            <div id="escopo" class="page"><h2 class="text-3xl font-bold mb-6">Termo de Abertura e Escopo</h2><div class="bg-white p-6 rounded-lg shadow"><div class="overflow-x-auto"><p id="escopo-view" class="whitespace-pre md:whitespace-pre-wrap text-gray-700 leading-relaxed"></p></div></div></div>
	    <div id="eap" class="page"><h2 class="text-3xl font-bold mb-6">EAP - Estrutura Analítica do Projeto</h2><div class="bg-white p-6 rounded-lg shadow"><div class="overflow-x-auto"><pre id="eap-view" class="whitespace-pre text-gray-700 font-mono text-sm"></pre></div></div></div>
	    <div id="cronograma" class="page"><h2 class="text-3xl font-bold mb-6">Lista de Tarefas do Cronograma</h2><div class="bg-white p-6 rounded-lg shadow"><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left">Tarefa (ID)</th><th class="px-6 py-3 text-left">Responsável</th><th class="px-6 py-3 text-left">Início</th><th class="px-6 py-3 text-left">Fim</th></tr></thead><tbody id="cronograma-table-view"></tbody></table></div></div></div>
	    <div id="riscos" class="page"><h2 class="text-3xl font-bold mb-6">Matriz de Riscos</h2><div class="bg-white p-6 rounded-lg shadow"><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left">Risco</th><th class="px-6 py-3 text-left">Probabilidade</th><th class="px-6 py-3 text-left">Impacto</th><th class="px-6 py-3 text-left">Mitigação</th></tr></thead><tbody id="riscos-table-view"></tbody></table></div></div></div>
	    <div id="reunioes" class="page"><h2 class="text-3xl font-bold mb-6">Atas de Reunião</h2><div class="bg-white p-6 rounded-lg shadow"><div class="overflow-x-auto"><div id="reunioes-list-view" class="space-y-4 whitespace-pre"></div></div></div></div>
	    <div id="links" class="page"><h2 class="text-3xl font-bold mb-6">Links Úteis</h2><div class="bg-white p-6 rounded-lg shadow"><div class="overflow-x-auto"><div id="links-list-view" class="space-y-2 whitespace-pre"></div></div></div></div>
	    <div id="avisos" class="page"><h2 class="text-3xl font-bold mb-6">Quadro de Avisos</h2><div class="bg-white p-6 rounded-lg shadow"><div class="overflow-x-auto"><div id="avisos-list-view" class="space-y-4 whitespace-pre"></div></div></div></div>
	    
	    <div id="edicao" class="page space-y-8">
                <h2 class="text-3xl font-bold"></h2>
                
                <div class="bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-4">Escopo</h3><textarea id="escopo-text-edit" class="w-full h-60 p-2 border rounded" placeholder="Descreva aqui o escopo..."></textarea><button id="salvar-escopo-edit" class="mt-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">Guardar Escopo</button></div>
                <div class="bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-4">EAP</h3><textarea id="eap-text-edit" class="w-full h-60 p-2 border rounded font-mono text-sm" placeholder="Digite sua EAP aqui. Use espaços ou tabs para criar a hierarquia."></textarea><button id="salvar-eap-edit" class="mt-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">Guardar EAP</button></div>
                <div class="bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-4">Avisos</h3><form id="aviso-form-edit" class="mt-4 flex flex-col md:flex-row gap-4"><input type="text" id="aviso-texto-edit" placeholder="Escreva um novo aviso..." class="p-2 border rounded w-full" required><button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">Publicar</button></form><div id="avisos-list-edit" class="text-gray-700 space-y-2 mt-4"></div></div>
                <div class="bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-4">Cronograma</h3><form id="cronograma-form" class="mb-4 grid grid-cols-1 md:grid-cols-5 gap-4 items-end"><input type="text" id="cronograma-id" placeholder="ID da Tarefa" class="p-2 border rounded" required><input type="text" id="cronograma-responsavel" placeholder="Responsável" class="p-2 border rounded" required><div><label class="text-sm">Início</label><input type="date" id="cronograma-inicio" class="p-2 border rounded w-full" required></div><div><label class="text-sm">Fim</label><input type="date" id="cronograma-fim" class="p-2 border rounded w-full" required></div><button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 h-10">Adicionar Tarefa</button></form><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left">Tarefa (ID)</th><th class="px-6 py-3 text-left">Responsável</th><th class="px-6 py-3 text-left">Início</th><th class="px-6 py-3 text-left">Fim</th><th class="px-6 py-3 text-left">Ação</th></tr></thead><tbody id="cronograma-table-edit"></tbody></table></div></div>
                <div class="bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-4">Matriz de Riscos</h3><form id="risco-form" class="mb-4 grid grid-cols-1 md:grid-cols-3 gap-4"><input type="text" id="risco-descricao" placeholder="Descrição do Risco" class="p-2 border rounded col-span-1 md:col-span-3" required><select id="risco-probabilidade" class="p-2 border rounded"><option>Baixa</option><option>Média</option><option>Alta</option></select><select id="risco-impacto" class="p-2 border rounded"><option>Baixo</option><option>Médio</option><option>Alto</option></select><button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">Adicionar Risco</button><textarea id="risco-mitigacao" placeholder="Plano de Mitigação" class="p-2 border rounded col-span-1 md:col-span-3 h-20"></textarea></form><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left">Risco</th><th class="px-6 py-3 text-left">Probabilidade</th><th class="px-6 py-3 text-left">Impacto</th><th class="px-6 py-3 text-left">Mitigação</th><th class="px-6 py-3 text-left">Ação</th></tr></thead><tbody id="riscos-table-edit"></tbody></table></div></div>
                <div class="bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-4">Atas de Reunião</h3><form id="reuniao-form" class="mb-4 grid grid-cols-1 md:grid-cols-2 gap-4"><input type="date" id="reuniao-data" class="p-2 border rounded" required><input type="text" id="reuniao-participantes" placeholder="Participantes" class="p-2 border rounded" required><textarea id="reuniao-pauta" placeholder="Pauta e Resultados da Reunião" class="p-2 border rounded col-span-1 md:col-span-2 h-40"></textarea><button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 col-span-1 md:col-span-2">Adicionar Ata</button></form><div id="reunioes-list-edit" class="space-y-4"></div></div>
                <div class="bg-white p-6 rounded-lg shadow"><h3 class="text-xl font-semibold mb-4">Links Úteis</h3><form id="link-form" class="mb-4 grid grid-cols-1 md:grid-cols-3 gap-4"><input type="url" id="link-url" placeholder="URL do Link" class="p-2 border rounded col-span-1 md:col-span-2" required><input type="text" id="link-descricao" placeholder="Descrição do Link" class="p-2 border rounded" required><button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 col-span-1 md:col-span-3">Adicionar Link</button></form><div id="links-list-edit" class="space-y-2"></div></div>
            </div>
        </div>
    </main>

    <script src="script.js"></script>

</body>
</html>
